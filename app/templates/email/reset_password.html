<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Password Reset Request</title>
        <style>
            body {
                font-family: sans-serif;
                line-height: 1.6;
                color: #333;
            }
            .container {
                max-width: 600px;
                margin: 20px auto;
                padding: 20px;
                border: 1px solid #ddd;
                border-radius: 5px;
            }
            .header {
                font-size: 1.2em;
                font-weight: bold;
                margin-bottom: 15px;
                color: #f0ad4e; /* Warning color */
            }
            .button {
                display: inline-block;
                padding: 12px 24px;
                background-color: #5cb85c;
                color: white;
                text-decoration: none;
                border-radius: 4px;
                margin: 15px 0;
                font-weight: bold;
            }
            .recovery-info {
                background-color: #f9f9f9;
                border-left: 4px solid #5bc0de;
                padding: 10px 15px;
                margin: 15px 0;
            }
            .warning {
                background-color: #fcf8e3;
                border-left: 4px solid #f0ad4e;
                padding: 10px 15px;
                margin: 15px 0;
            }
            .footer {
                margin-top: 20px;
                font-size: 0.9em;
                color: #777;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">Password Reset Request</div>
            <p>Hello {{ user.username }},</p>
            <p>We received a request to reset the password for your account associated with {{ user.email }}.</p>
            
            <p>To reset your password, click the button below:</p>
            <a href="{{ reset_url }}" class="button">Reset My Password</a>
            
            <p>If the button doesn't work, you can copy and paste this link into your browser:</p>
            <p style="word-break: break-all; background-color: #f5f5f5; padding: 10px; border-radius: 3px;">{{ reset_url }}</p>
            
            {% if has_recovery_keys %}
            <div class="recovery-info">
                <strong>Recovery Keys Available:</strong>
                <p>You have {{ unused_keys }} unused recovery key(s) that can be used to preserve your encrypted credentials during the password reset. If you have your recovery keys available, please use them during the reset process to maintain access to your stored credentials.</p>
            </div>
            {% else %}
            <div class="warning">
                <strong>Important:</strong>
                <p>You do not have any recovery keys set up. Resetting your password without recovery keys will result in the loss of access to your encrypted credentials. Consider setting up recovery keys after resetting your password to protect your data in the future.</p>
            </div>
            {% endif %}
            
            <div class="warning">
                <strong>Security Notice:</strong>
                <p>This reset link will expire in 1 hour for security reasons. If you didn't request this password reset, you can safely ignore this email - your account remains secure.</p>
            </div>
            
            <p>If you continue to have trouble accessing your account or if you didn't request this reset, please contact support.</p>
            
            <p>Thank you,</p>
            <p>The Password Manager Team</p>
            <div class="footer">This is an automated message. Please do not reply.</div>
        </div>
    </body>
</html>